<!-- unit-node.component.html -->
<li class="list-group-item border-0 p-0">
  <div class="d-flex justify-content-between align-items-center mb-1">
    <div class="d-flex align-items-center">
      <span class="d-inline-flex align-items-center" style="width: 1.25rem;">
        <i
          class="fa"
          [ngClass]="{
            'fa-angle-right': !node.expanded && node.children?.length,
            'fa-angle-down': node.expanded && node.children?.length
          }"
          (click)="toggle()"
          *ngIf="node.children?.length"
          style="cursor: pointer;"
        ></i>
      </span>
      <i class="fa fa-folder text-warning ml-2 mr-1"></i>
      <span class="font-weight-bold" 
      [ngStyle]="{ 'color': node.highlighted ? '#007bff' : 'inherit' }"
        >{{ node.name }}</span>
    </div>
    <div class="position-relative unit-menu-container" style="z-index: 20;">
      <button class="btn btn-sm btn-light" (click)="toggleMenu()">
        <i class="fa fa-ellipsis-v"></i>
      </button>
    <div *ngIf="showMenu" class="dropdown-menu show position-absolute text-nowrap"
     style="left: auto; right: 100%; top: 0; transform: translateX(-8px); z-index: 1060; min-width: 180px;">
        <button class="dropdown-item d-flex align-items-center" (click)="editUnit()">
          <i class="fa fa-edit mr-2"></i> <span>Sửa</span>
        </button>
        <button class="dropdown-item d-flex align-items-center" (click)="addChild()">
          <i class="fa fa-plus mr-2"></i> <span>Thêm đơn vị con</span>
        </button>
        <button class="dropdown-item text-danger d-flex align-items-center" (click)="deleteUnit()">
          <i class="fa fa-trash mr-2"></i> <span>Xóa</span>
        </button>
      </div>
    </div>
  </div>

  <ul class="list-unstyled pl-4 mt-2" *ngIf="node.expanded">
    <ng-container *ngFor="let child of node.children">
      <app-unit-node
        [node]="child"
        (editUnitEvent)="editUnitEvent.emit($event)"
        (deleteUnitEvent)="deleteUnitEvent.emit($event)"
        (addChildEvent)="addChildEvent.emit($event)"
      ></app-unit-node>
    </ng-container>
  </ul>
</li>
