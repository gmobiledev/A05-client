<div class="card mt-3">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h4 class="card-title mb-0 font-weight-bold">L·ªãch s·ª≠ chuy·ªÉn s·ª≠ d·ª•ng SIM</h4>
    </div>

    <form (ngSubmit)="onSubmitSearch()" class="row">
      <div class="col-md-4 mb-2">
        <input class="form-control" [(ngModel)]="searchForm.phone_or_serial" name="phone_or_serial" placeholder="Nh·∫≠p s·ªë ƒêT ho·∫∑c serial SIM" />
      </div>
            <div class="col-md-4 mb-2">
            <ng-select
              class="custom-ng-select w-100"
              [items]="listSellChannel"
              bindLabel="name"
              bindValue="id"
              name="channel_name"
              [(ngModel)]="searchForm.channel_id"
              placeholder="Ch·ªçn kho"
              [searchable]="true"
              [clearable]="false"
              [dropdownPosition]="'auto'"
              >
              <ng-template ng-header-tmp>
                <div style="padding: 8px; color: #6c757d; font-size: 0.875rem;">
                  üîç G√µ ƒë·ªÉ t√¨m ki·∫øm kho...
                </div>
              </ng-template>
            </ng-select>
      </div>
      <div class="col-md-4 mb-2">
        <input class="form-control" [(ngModel)]="searchForm.new_user_name" name="new_user_name" placeholder="T√™n ng∆∞·ªùi nh·∫≠n m·ªõi" />
      </div>
      <div class="col-md-4 mb-2">
        <input
          type="text"
          placeholder="Kho·∫£ng th·ªùi gian"
          [ngModelOptions]="{ standalone: true }"
          ngxDaterangepickerMd
          [(ngModel)]="dateRange"
          [ranges]="ranges"
          [locale]="{ applyLabel: 'Ch·ªçn', format: 'DD/MM/YYYY' }"
          [showCustomRangeLabel]="true"
          [alwaysShowCalendars]="true"
          name="date_range"
          class="form-control"
        />
      </div>
      
      <div class="col-md-12 d-flex mt-1">
        <button type="submit" class="btn btn-info mr-1">
          <i data-feather="search" class="mr-50"></i> L·ªçc k·∫øt qu·∫£
        </button>
        <button type="button" class="btn btn-success" (click)="exportExcel()">
          <i data-feather="file" class="mr-50"></i> Xu·∫•t Excel
        </button>
      </div>
    </form>
  </div>

  <div class="table-responsive mt-2">
    <div class="col-md-12 mb-1">
      <span>T·ªïng s·ªë: </span> <b>{{ totalItems }}</b>
    </div>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>STT</th>
          <th>Kho</th>
          <th>S·ªë ƒëi·ªán tho·∫°i</th>
          <th>Serial SIM</th>
          <th>Th·ªùi gian c·∫≠p nh·∫≠t</th>
          <th>T√™n</th>
          <th>M√£ CBNV</th>
          <th>SƒêT li√™n h·ªá</th>
          <th>Email</th>
          <th>ƒê∆°n v·ªã</th>
          <th>Ghi ch√∫</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of list; index as i">
            <td>{{ (searchForm.page - 1) * searchForm.limit + (i + 1) }}</td>
          <td>{{ item.sell_channel_name || '-' }}</td>
          <td>{{ item.msisdn || '-' }}</td>
          <td>{{ item.serial || '-' }}</td>
          <td>{{ item.updated_at | date: 'dd/MM/yyyy HH:mm' }}</td>
          <td>{{ item.new_user?.full_name || '-' }}</td>
          <td>{{ item.new_user?.user_code || '-' }}</td>
          <td>{{ item.new_user?.mobile || '-' }}</td>
          <td>{{ item.new_user?.email || '-' }}</td>
          <td>{{ getUnitName(item.new_user?.unit_id) || '-' }}</td>
          <td>{{ item.note || '-' }}</td>
        </tr>
        <tr *ngIf="list.length === 0">
          <td colspan="7" class="text-center text-muted">Kh√¥ng c√≥ d·ªØ li·ªáu</td>
        </tr>
      </tbody>
    </table>

 <ngb-pagination
      class="d-flex justify-content-end pr-3 pt-2"
      [collectionSize]="totalItems"
      [(page)]="searchForm.page"
      [pageSize]="searchForm.limit"
      [boundaryLinks]="true"
      (pageChange)="loadPage($event)"
    >
      <ng-template ngbPaginationPages let-page let-pages="pages">
        <li class="ngb-custom-pages-item" *ngIf="pages.length > 0">
          <div class="mb-3 d-flex flex-nowrap px-2 align-items-center">
            <label for="paginationInput" class="col-form-label me-2 ms-1">Trang</label>
            <input
              #i
              id="paginationInput"
              type="text"
              inputmode="numeric"
              pattern="[0-9]*"
              class="form-control custom-pages-input"
              [value]="searchForm.page"
              (keyup.enter)="loadPage(i.value)"
              (blur)="loadPage(i.value)"
              (input)="formatInput($event.target)"
              style="width: 3.5rem"
            />
            <span class="col-form-label text-nowrap px-2">c·ªßa {{ pages.length }}</span>
          </div>
        </li>
      </ng-template>
    </ngb-pagination>
  </div>
</div>